tribe.events=tribe.events||{},tribe.events.categoryColors=tribe.events.categoryColors||{},tribe.events.categoryColors.categoryPicker=function(){"use strict";const e={picker:".tec-events-category-color-filter",dropdown:".tec-events-category-color-filter__dropdown",dropdownLabel:".tec-events-category-color-filter__dropdown-item label",checkbox:".tec-events-category-color-filter__checkbox",dropdownIcon:".tec-events-category-color-filter__dropdown-icon",dropdownVisible:"tec-events-category-color-filter__dropdown--visible",resetButton:".tec-events-category-color-filter__reset",pickerOpen:"tec-events-category-color-filter--open",pickerAlignRight:"tec-events-category-color-filter--align-right",dropdownClose:".tec-events-category-color-filter__dropdown-close",dataBound:"data-bound",childParentPairs:[{child:".tribe-events-calendar-list__event",parent:".tribe-events-calendar-list__event-row"},{child:".tribe-events-calendar-day__event",parent:".tribe-events-calendar-day__event"},{child:".tribe-events-calendar-month__calendar-event",parent:".tribe-events-calendar-month__calendar-event"},{child:".tribe-events-pro-summary__event",parent:".tribe-events-pro-summary__event"},{child:".tribe-events-pro-photo__event",parent:".tribe-events-pro-photo__event"},{child:".tribe-events-pro-week-grid__event",parent:".tribe-events-pro-week-grid__event"},{child:".tribe-events-pro-week-grid__multiday-event",parent:".tribe-events-pro-week-grid__multiday-event-wrapper"},{child:".tribe-events-calendar-month__multiday-event",parent:".tribe-events-calendar-month__multiday-event"},{child:".tribe-events-calendar-month-mobile-events__mobile-event",parent:".tribe-events-calendar-month-mobile-events__mobile-event-row"},{child:".tribe-events-pro-week-mobile-events__event",parent:".tribe-events-pro-week-mobile-events__event-row"},{child:".tribe-events-pro-map__event-card-wrapper",parent:".tribe-events-pro-map__event-card-wrapper"}],filteredHide:"tec-category-filtered-hide",colorCircle:"tec-events-category-color-filter__color-circle",colorCircleDefault:"tec-events-category-color-filter__color-circle--default",colorCircleDefaultN:e=>`tec-events-category-color-filter__color-circle--default-${e}`,pickerContainer:".tec-events-category-color-filter"},t=new Set;let r=!1,o=null;const n=e=>document.querySelector(e),i=e=>document.querySelectorAll(e),c=t=>{const r=n(e.dropdown);if(r&&r.contains(t.target))return;t.stopPropagation();const o=t.currentTarget;r&&(l(r)?a(o,r):s(o,r))},s=(t,r)=>{r.classList.add(e.dropdownVisible),t.classList.add(e.pickerOpen),p(t,r)},a=(t,r)=>{r.classList.remove(e.dropdownVisible),t.classList.remove(e.pickerOpen)},l=t=>t.classList.contains(e.dropdownVisible),d=t=>{t.target.closest(e.pickerContainer)||i(e.picker).forEach((t=>{const r=t.querySelector(e.dropdown);r&&l(r)&&a(t,r)}))},p=(e,t,r=!1)=>{if(!t.isConnected||!t.offsetParent)return;"static"===window.getComputedStyle(e).position&&(e.style.position="relative"),Object.assign(t.style,{left:"",right:"",top:"",position:"absolute"});const{left:o}=e.getBoundingClientRect(),n=window.innerWidth,i=e.offsetHeight;o>n/2?t.style.right="0px":t.style.left="0px",t.style.top=`${i}px`;const c=t.getBoundingClientRect().bottom,s=window.innerHeight- -8;if(c>s){const e=i-(c-s);t.style.top=`${e}px`}r||v(t)||window.requestAnimationFrame((()=>p(e,t,!0)))},v=e=>{const t=e.getBoundingClientRect();return t.top>=8&&t.left>=8&&t.bottom<=window.innerHeight-8&&t.right<=window.innerWidth-8},_=()=>{const r=document.getElementById("tec-category-color-legend");if(r)if(r.innerHTML="",t.size>0)Array.from(t).slice(0,5).forEach((t=>{const o=document.createElement("span");o.classList.add(e.colorCircle,`tribe_events_cat-${t}`),r.appendChild(o)}));else{const t=i(e.dropdownLabel);Array.from(t).slice(0,5).forEach((t=>{const o=t.dataset.category;if(o){const t=document.createElement("span");t.classList.add(e.colorCircle,`tribe_events_cat-${o}`),r.appendChild(t)}}))}},w=()=>{i(e.checkbox).forEach((e=>{e.checked=!1})),t.clear(),u(),_()},b=r=>{const o=r.target.closest(e.checkbox);if(!o)return;const n=o.closest("label");if(!n)return;const i=n.dataset.category;i&&(o.checked?t.add(i):t.delete(i),u(),_())},u=()=>{const r=[...t];e.childParentPairs.flatMap((e=>[...document.querySelectorAll(e.parent)])).forEach((t=>{let o=t;[...o.classList].some((e=>e.startsWith("tribe_events_cat-")))||(o=t.querySelector('[class*="tribe_events_cat-"]'));const n=!!o&&h(o,r);t.classList.toggle(e.filteredHide,r.length>0&&!n)}))},h=(e,t)=>{const r=[...e.classList].filter((e=>e.startsWith("tribe_events_cat-")));return t.some((e=>r.includes(`tribe_events_cat-${e}`)))},g=()=>{if(r)return;r=!0;const e=window.XMLHttpRequest.prototype.open;window.XMLHttpRequest.prototype.open=function(t,r,...o){return r.includes("/wp-json/tribe/views/v2/html")&&this.addEventListener("load",(function(){if(4===this.readyState&&200===this.status)try{setTimeout((()=>{y(),f(),_()}),50)}catch(e){y()}})),e.apply(this,[t,r,...o])}},f=()=>{i(e.checkbox).forEach((e=>{const r=e.closest("label"),o=r?.dataset.category;o&&(e.checked=t.has(o))})),u(),_()},y=(t=0)=>{t>5||window.requestAnimationFrame((()=>{const r=n(e.picker);r?(m(),k(r)||(L(),r.setAttribute(e.dataBound,"true"))):setTimeout((()=>y(t+1)),50)}))},m=()=>{const t=n(e.picker);t&&k(t)&&t.removeAttribute(e.dataBound)},k=t=>t.hasAttribute(e.dataBound),L=()=>{const t=n(e.picker),r=n(e.dropdownClose),i=n(e.resetButton);t&&t.addEventListener("click",c),document.addEventListener("click",d);const s=n(e.dropdown);s&&s.addEventListener("change",b),r&&r.addEventListener("click",(t=>{t.stopPropagation();const r=n(e.picker),o=n(e.dropdown);r&&o&&a(r,o)})),i&&i.addEventListener("click",w),o||(o=new window.MutationObserver(m),o.observe(document.body,{childList:!0,subtree:!0})),window.addEventListener("beforeunload",m)},C=()=>{g(),L(),_()};return document.addEventListener("DOMContentLoaded",C),{init:C,ensureBindings:y}}(),window.tec=window.tec||{},window.tec.events=window.tec.events||{},window.tec.events.views=window.tec.events.views||{},window.tec.events.views.categoryColorSelector={};