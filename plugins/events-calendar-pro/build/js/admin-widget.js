!function(e,t){"use strict";const i={},a=e(document.body);i.search_id=function(e){let t;return void 0!==e.id?t=e.id:void 0!==e.ID?t=e.ID:void 0!==e.value&&(t=e.value),void 0===e?void 0:t},i.calendar_toggle=function(e){e.find(".calendar-widget-filters-title").hide(),e.find(".calendar-widget-filters-operand").hide();const t=e.find(".calendar-widget-added-filters");if(t.length){const i=t.val()?JSON.parse(t.val()):new Object;let a=0;for(const e in i)a+=i[e].length;a>0&&(e.find(".calendar-widget-filters-title").show(),a>1&&e.find(".calendar-widget-filters-operand").show())}},i.select2=function(){const a=e(this),n={};if(a.hasClass("select2-container")&&a.select2("destroy"),a.next().hasClass("select2-container")&&a.next().remove(),e("body").hasClass("wp-customizer")&&(n.dropdownCssClass="tribe-customizer-select2"),a.is("select")||(n.id=i.search_id),n.allowClear=!0,a.data("prevent-clear")&&(n.allowClear=!1),a.data("options")&&(n.data=a.data("options")),a.data("hide-search")&&(n.minimumResultsForSearch=1/0),a.is("[multiple]")&&(n.multiple=!0,t.isArray(a.data("separator"))?n.tokenSeparators=a.data("separator"):n.tokenSeparators=[a.data("separator")],n.separator=a.data("separator"),n.regexSeparatorElements=["^("],n.regexSplitElements=["(?:"],e.each(n.tokenSeparators,(function(e,t){n.regexSeparatorElements.push("[^"+t+"]+"),n.regexSplitElements.push("["+t+"]")})),n.regexSeparatorElements.push(")$"),n.regexSplitElements.push(")"),n.regexSeparatorString=n.regexSeparatorElements.join(""),n.regexSplitString=n.regexSplitElements.join(""),n.regexToken=new RegExp(n.regexSeparatorString,"ig"),n.regexSplit=new RegExp(n.regexSplitString,"ig")),n.matcher=function(e,i){let a=0==i.toUpperCase().indexOf(e.toUpperCase());if(!a&&void 0!==n.tags){const d=t.where(n.tags,{text:i});n.tags.length>0&&t.isObject(d)&&(a=0==obj.search_id(d[0]).toUpperCase().indexOf(e.toUpperCase()))}return a},a.data("tags")&&(n.tags=a.data("options"),n.initSelection=function(i,a){const d=[];e(i.val().split(n.regexSplit)).each((function(){let e={id:this,text:this};if(n.tags.length>0&&t.isObject(n.tags[0])){const i=t.where(n.tags,{value:this});i.length>0&&(e=i[0],e={id:e.value,text:e.text})}d.push(e)})),a(d)},n.createSearchChoice=function(e,t){if(e.match(n.regexToken))return{id:e,text:e}},0===n.tags.length&&(n.formatNoMatches=function(){return a.attr("placeholder")})),a.data("source")){const e=a.data("source");n.data={results:[]},n.escapeMarkup=function(e){return e},n.ajax={dataType:"json",type:"POST",url:window.ajaxurl,processResults:e=>(a.data("lastOptions",e.data),e.data)},n.ajax.data=function(t,i){return{action:"tribe_widget_dropdown_"+e,disabled:a.data("disabled"),selected:a.data("selected"),search:t,page:i}}}a.on("open",(function(){e(".select2-drop").css("z-index",1e7)})).trigger("change.select2").select2TEC(n)},i.conditional=function(t,i){const a=e(t),n=a.data("tribeConditionalField"),d=i.find(".js-tribe-conditional").filter('[data-tribe-conditional-field="'+n+'"]'),r=a.val();d.hide().each((function(){const t=e(this);t.hasClass("tribe-select2")&&t.prev(".select2-container").hide()})).filter('[data-tribe-conditional-value="'+r+'"]').show().each((function(){const t=e(this);t.hasClass("tribe-select2")&&t.hide().prev(".select2-container").show()}))},i.showFilters=function(t){const i=t.find(".calendar-widget-filters-container"),a=i.find(".calendar-widget-added-filters");a.length&&a.val()&&a.val().length&&null!==a.val()&&"null"!==a.val()&&(i.addClass("calendar-widget-filters-container--show"),e(".fl-nanoscroller").length&&void 0!==typeof FLBuilder&&FLBuilder._initScrollbars())},i.hideFilters=function(e){const t=e.find(".calendar-widget-filters-container"),i=t.find(".calendar-widget-added-filters");if(!i.length)return void t.removeClass("calendar-widget-filters-container--show");let a=i.val();a&&a.length?(a=JSON.parse(a),Object.keys(a).reduce((function(e,t){return!a[t].length&&null!==a[t].length&&e}),!0)&&t.removeClass("calendar-widget-filters-container--show")):t.removeClass("calendar-widget-filters-container--show")},i.setup=function(t,a){if(void 0===a){const i=e(t.target);if(!i.parents(".widget-top").length||i.parents("#available-widgets").length)return;(a=i.closest("div.widget")).find("[data-depends]").trigger("setup.dependency").trigger("verify.dependency")}void 0!==a&&("object"==typeof a&&(a=e(a)),"jQuery"!=typeof a&&(a.is('[id*="tribe-"]')||!a.is(".so-content.panel-dialog")||a.find('[id^="widget-tribe-events-"]'))&&(a.is('[id*="__i__"]')||(a.find(".tribe-widget-select2").each(i.select2).trigger("change.select2"),a.on("change",".js-tribe-condition",(function(){i.conditional(this,a)})),i.showFilters(a),e("body").hasClass("wp-customizer")||(e.isNumeric(t)||"widget-updated"===t.type)&&(a.find(".js-tribe-condition").each((function(){i.conditional(this,a)})),a.find("[data-depends]").trigger("setup.dependency").trigger("verify.dependency")))))},e((function(t){e("body").hasClass("wp-customizer")||(i.showFilters,e(".tribe-widget-form").each(i.setup))})),e(document).on({"widget-added widget-updated"(t,a){const n=e(a);i.setup(t,n),i.showFilters(n),n.find("[data-depends]").trigger("setup.dependency").trigger("verify.dependency")}}).on("change",".calendar-widget-add-filter",(function(t){const a=e(this),n=a.parents(".tribe-widget-form"),d=n.find(".calendar-widget-filter-list"),r=n.find(".calendar-widget-added-filters");let s=r.val()?JSON.parse(r.val()):{};const o=a.val(),l=a.data("disabled")?a.data("disabled"):[],c=a.data("lastOptions");if(void 0===o)return;let g;if(null!==s&&"object"==typeof s||(s={}),void 0!==c&&void 0!==c.results&&c.results.forEach((function(e){e.tax&&(s[e.tax.name]||(s[e.tax.name]=[]),e.children.forEach((function(t){t&&t.id==o&&(g=t,s[e.tax.name].push(t.id))})))})),!g)return;if(-1!==e.inArray(o.id,s[g.taxonomy.name])&&-1!==e.inArray(o,s[g.taxonomy.name]))return void a.val("");if(d.find('[data-term="'+g.id+'"]').length)return;s[g.taxonomy.name].push(o.id),r.val(JSON.stringify(s));const f=e("<a/>").attr({"data-tax":g.taxonomy.name,"data-term":g.id,class:"calendar-widget-remove-filter",href:"#"}).text("(remove)"),p=e("<span/>").append(f),u=e("<li/>").addClass("calendar-widget-filter-item").html(g.taxonomy.labels.name+": "+g.text).append(p);d.append(u),l.push(g.id),a.data("disabled",l),i.showFilters(n),a.val("")})).on("click",".calendar-widget-remove-filter",(function(a){a.preventDefault();const n=e(this),d=n.parents(".tribe-widget-form"),r=d.find(".calendar-widget-add-filter").not(".select2-container"),s=d.find(".calendar-widget-added-filters"),o=s.val()?JSON.parse(s.val()):{},l=n.data("term"),c=n.data("tax"),g=r.data("disabled")?r.data("disabled"):[];o[c]&&(o[c]=t.without(o[c],l.toString(),null)),s.val(JSON.stringify(o)),r.data("disabled",t.without(g,l.toString())),n.closest("li").remove(),d.find('input[name^="widget-tribe-"]').trigger("change"),i.hideFilters(d)})).on("click",".so-close",(function(t){e(".calendar-widget-add-filter").select2("close")})),a.on("click.widgets-toggle",i.setup),e(document).on("panelsopen",(function(t){e(".so-content.panel-dialog").each((function(){const a=e(this);if(!a.hasClass("widget")){let n=a.find('[id^="widget-tribe-"]').filter('[id$="-title"]').attr("id");if(!n)return;n=n.substring(0,n.indexOf("-title")),a.attr("id",n).addClass("widget"),i.setup(t,a),e(".so-duplicate").on("click",(function(t){e(".calendar-widget-add-filter").select2("close")})),e(".so-delete").on("click",(function(t){e(".calendar-widget-add-filter").select2("close")}))}}))})),e(document).on("change",".fl-builder-settings-lightbox",(function(t){i.setup(t,e(".tribe-widget-form").first())}))}(jQuery.noConflict(),_),window.tec=window.tec||{},window.tec.eventsPro=window.tec.eventsPro||{},window.tec.eventsPro.adminWidget={};